<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Book Appointment</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        #main {
            max-width: 600px;
            margin: 50px auto;
            padding: 30px;
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
        }
        h2 {
            color: #0d6efd;
            text-align: center;
            margin-bottom: 20px;
        }
    </style>
</head>
<body>

<div id="main">
    <h2>Book Appointment - {{ department.name }}</h2>
    <form action="" method="POST">
        
        <!-- Doctor Selection -->
        <div class="mb-3">
            <label for="doctor">Select Doctor</label>
            <select class="form-select" name="doctor_id" required onchange="this.form.submit()">
                {% if doctors %}
                    {% for doctor in doctors %}
                        <option value="{{ doctor.id }}" {% if doctor == selected_doctor %}selected{% endif %}>
                            {{ doctor.name }}
                        </option>
                    {% endfor %}
                {% else %}
                    <option disabled selected>No doctors available</option>
                {% endif %}
            </select>
        </div>

        <!-- Appointment Date Selection -->
        <div class="mb-3">
            <label for="appointment_date">Select Date</label>
            <select class="form-select" name="appointment_date" required onchange="this.form.submit()">
                {% if available_dates %}
                    {% for d in available_dates %}
                        <option value="{{ d }}" {% if d == appointment_date %}selected{% endif %}>
                            {{ d }}
                        </option>
                    {% endfor %}
                {% else %}
                    <option disabled selected>No available dates</option>
                {% endif %}
            </select>
        </div>

        <!-- Slot Selection -->
        <div class="mb-3">
            <label for="slot">Select Time Slot</label>
            <select class="form-select" name="slot" required>
                <option value="" disabled selected>Select Time Slot</option>
                {% if selected_doctor and appointment_date and slots_data.get(appointment_date) %}
                    {% for slot_name, slot_time in slots_data[appointment_date].items() %}
                        {% if slot_time %}
                            <option value="{{ slot_name }}">{{ slot_time }}</option>
                        {% endif %}
                    {% endfor %}
                {% else %}
                    <option disabled>No slots available</option>
                {% endif %}
            </select>
        </div>

        <!-- BUTTON ROW -->
        <div class="d-flex justify-content-between mt-4">

            <!-- BACK BUTTON LEFT -->
            <a href="{% if session['role'] == 'admin' %}
                        {{ url_for('admin_dashboard') }}
                    {% elif session['role'] == 'doctor' %}
                        {{ url_for('doctor_dashboard') }}
                    {% else %}
                        {{ url_for('patient_dashboard') }}
                    {% endif %}"
            class="btn btn-secondary">
                Back to Dashboard
            </a>


            <!-- BOOK BUTTON RIGHT -->
            <button type="submit" class="btn btn-primary">
                Book Appointment
            </button>

        </div>

    </form>
</div>

</body>
</html>
